{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\").default;\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\").default;\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar R = _interopRequireWildcard(require(\"ramda\"));\n\nvar P = _interopRequireWildcard(require(\"@react-pdf/primitives\"));\n\nvar _emoji = _interopRequireDefault(require(\"../text/emoji\"));\n\nvar _fetchImage = _interopRequireDefault(require(\"../image/fetchImage\"));\n\nvar isImage = R.propEq('type', P.Image);\n/**\n * Get all asset promises that need to be resolved\n *\n * @param {Object} root node\n * @returns {Array} asset promises\n */\n\nvar fetchAssets = function fetchAssets(fontStore, node) {\n  var _node$children;\n\n  var promises = [];\n  var listToExplore = ((_node$children = node.children) === null || _node$children === void 0 ? void 0 : _node$children.slice(0)) || [];\n  var emojiSource = fontStore ? fontStore.getEmojiSource() : null;\n\n  while (listToExplore.length > 0) {\n    var _n$style;\n\n    var n = listToExplore.shift();\n\n    if (isImage(n)) {\n      promises.push((0, _fetchImage.default)(n));\n    }\n\n    if (fontStore && (_n$style = n.style) !== null && _n$style !== void 0 && _n$style.fontFamily) {\n      promises.push(fontStore.load(n.style));\n    }\n\n    if (typeof n === 'string') {\n      promises.push.apply(promises, (0, _emoji.default)(n, emojiSource));\n    }\n\n    if (typeof n.value === 'string') {\n      promises.push.apply(promises, (0, _emoji.default)(n.value, emojiSource));\n    }\n\n    if (n.children) {\n      n.children.forEach(function (childNode) {\n        listToExplore.push(childNode);\n      });\n    }\n  }\n\n  return promises;\n};\n/**\n * Fetch image, font and emoji assets in parallel.\n * Layout process will not be resumed until promise resolves.\n *\n * @param {Object} root node\n * @param {Object} fontStore font store\n * @returns {Object} root node\n */\n\n\nvar resolveAssets = /*#__PURE__*/function () {\n  var _ref = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(node, fontStore) {\n    var promises;\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            promises = fetchAssets(fontStore, node);\n            _context.next = 3;\n            return Promise.all(promises);\n\n          case 3:\n            return _context.abrupt(\"return\", node);\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function resolveAssets(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar _default = resolveAssets;\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}